!function(a,b){"use strict";if(function(){try{if(!("localStorage"in a&&null!==a.localStorage))return!1}catch(a){return!1}var b="abtf";try{localStorage.setItem(b,b),localStorage.removeItem(b)}catch(a){return!1}return!("undefined"==typeof a.Worker||!a.Worker)}()){var c={prefix:"abtf-",default_expire:86400,isValidItem:null,timeout:5e3,now:function(){return+new Date/1e3},saveScript:function(a,b,d){var e={},f=this.now();if(e.date=f,e.expire=f+(d||c.default_expire),b instanceof Array){e.chunked=!0,e.chunks=b.length;for(var g=[],h=b.length,i=0;i<h;i++)g.push(b[i])}else{var g=!1;e.data=b}if(this.add(a,e),g)for(var h=g.length,i=0;i<h;i++)this.add("chunk:"+i+":"+a,g[i])},getScript:function(a){var b=this.get(a);if(!b)return!1;if("undefined"!=typeof b.expire&&b.expire-this.now()<0)return!1;if("undefined"!=typeof b.chunked&&b.chunked===!0){for(var c,e=[],f=0;f<b.chunks;f++){if(c=this.get("chunk:"+f+":"+a),c===!1)return!1;e.push(c)}b.data=e.join("")}return d(b.data,"application/javascript")},add:function(a,b){try{return localStorage.setItem(c.prefix+a,JSON.stringify(b)),!0}catch(f){if(f.name.toUpperCase().indexOf("QUOTA")>=0){var d,e=[];for(d in localStorage)0===d.indexOf(c.prefix)&&e.push(JSON.parse(localStorage[d]));return e.length?(e.sort(function(a,b){return a.date-b.date}),c.remove(e[0].key),c.add(a,b)):void 0}return}},remove:function(a){return localStorage.removeItem(c.prefix+a),this},get:function(a){var b=localStorage.getItem(c.prefix+a);try{return JSON.parse(b||"false")}catch(a){return!1}},clear:function(a){var b,d,e=this.now();for(b in localStorage)d=b.split(c.prefix)[1],d&&(!a||c.get(d).expire<=e)&&c.remove(d)}},d=function(b,c){var d;try{d=new Blob([b],{type:c})}catch(e){a.BlobBuilder=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder,d=new BlobBuilder,d.append(b),d=d.getBlob(c)}return URL.createObjectURL(d)},e=function(){self.FETCH=self.fetch||!1,self.DEFAULT_TIMEOUT=5e3,self.MAX_CHUNK_SIZE=5e5,self.CHUNK_DATA=function(a,b){for(var c,d=Math.ceil(a.length/b),e=new Array(d),f=0;f<d;f++)c=f*b,e[f]=a.substring(c,c+b);return e};var a=function(a){var b=!1,c=function(c,d){if(!b){if(b=!0,g&&(clearTimeout(g),g=!1),!c&&d){var e=d.length;e>MAX_CHUNK_SIZE&&(d=CHUNK_DATA(d,MAX_CHUNK_SIZE))}RESOURCE_LOAD_COMPLETED(a,c,d)}};if(FETCH){var d={method:"GET",mode:"cors",cache:"default"},e=function(a){b||("object"==typeof a&&a.status&&(a=[a.status,a.statusText]),c(a))};FETCH(a.url,d).then(function(a){b||(a.ok?a.text().then(function(a){c(!1,a)}):c([a.status,a.statusText]))},e).catch(e);var f=a.timeout||DEFAULT_TIMEOUT;isNaN(f)&&(f=DEFAULT_TIMEOUT);var g=setTimeout(function(){b||c("timeout")},f)}else{var h=new XMLHttpRequest;h.open("GET",a.url,!0),h.responseType="text",h.onreadystatechange=function(){b||4===h.readyState&&(200!==h.status?c(h.statusText):c(!1,h.responseText))},h.onerror=function(){b||c(h.statusText)};var f=a.timeout||DEFAULT_TIMEOUT;isNaN(f)&&(f=DEFAULT_TIMEOUT);var g=setTimeout(function(){if(!b){try{h.abort()}catch(a){}c("timeout")}},f);h.send(null)}};self.RESOURCE_LOAD_COMPLETED=function(a,b,c){b?(b instanceof Array||"object"!=typeof b||(b=b.toString()),self.postMessage([2,a.i,b])):self.postMessage([1,a.i,c])},self.onmessage=function(b){var c=b.data;if(c instanceof Array)for(var d=c.length,e=0;e<d;e++)"object"==typeof c[e]&&"undefined"!=typeof c[e].url&&"undefined"!=typeof c[e].i&&a(c[e]);else{if("object"!=typeof c||"undefined"==typeof c.url||"undefined"==typeof c.i)throw new Error("Web Worker Script Loader: Invalid resource object");a(c)}}}.toString().replace(/^function\s*\(\s*\)\s*\{/,"").replace(/\}$/,""),f={workerUri:d(e,"application/javascript"),worker:!1,scriptIndex:0,scriptQueue:[],start:function(){this.worker=new Worker(this.workerUri),this.worker.addEventListener("message",this.handleMessage),this.worker.addEventListener("error",this.handleError)},stop:function(){this.worker&&(this.worker.removeEventListener("message",this.handleMessage),this.worker.removeEventListener("error",this.handleError),this.worker.terminate(),this.worker=!1)},handleMessage:function(a){var b=a.data,c=b[1];if("undefined"!=typeof f.scriptQueue[c])return 1===parseInt(b[0])?void f.scriptQueue[c].onData(b[2]):void(2===parseInt(b[0]))},handleError:function(a){},loadScript:function(b,c){this.worker||this.start(),b=a.Abtf.proxifyScript(b);var d=parseInt(this.scriptIndex);this.scriptIndex++,this.scriptQueue[d]={url:b,onData:c},this.worker.postMessage({url:b,i:d})}};f.start(),a.addEventListener("beforeunload",function(a){f.stop()}),c.clear(!0),a.Abtf.loadCachedScript=function(a,d,e){var g=c.getScript(a);return g?(b.loadScript(g,d,e),g):(b.loadScript(a,function(){f.loadScript(a,function(b){b&&c.saveScript(a,b)})},e),!1)},a.Abtf.cachedScriptUrl=function(a){var b=c.getScript(a);return b?b:(f.loadScript(a,function(b){b&&c.saveScript(a,b)}),a)}}}(window,window.Abtf);